### 협력

#### 요청하고 응답하며 협력하는 사람들
협력의 본질은 요청과 응답으로 연결되는 사람들의 네트워크이다.

여기서 말하는 **협력**은 한 사람이 다른 사람에게 도움을 요청할 때 시작되는데, 요청을 받은 사람은 일을 처리한 후 요청한 사람에게 지식이나 서비스를 제공하는 것으로 요청에 응답한다.

이러한 과정으로 협력은 다수의 연쇄적인 요청&응답으로 구성된다.

#### 재판 속 협력
앨리스 에피소드에서 왕과 하얀토끼, 증인이 등장해서 재판을 벌이는데, 이 또한 협력으로 요청하고 응답하는 과정이다.

왕이 A 인물로부터 증언을 듣는 과정을 요청과 응답 관점에서 보면 다음과 같다.

1. 누군가 왕에게 재판을 요청한다.
2. 왕이 재판에 필요한 증인을 부를 것을 하얀 토끼에게 요청한다.
3. 토끼는 A 인물에게 입장을 요청한다.
4. A 인물은 입장하여 응답한다.
5. A 인물의 입장은 동시에 2번 과정(왕이 증인 불러라)에 대한 응답이다.
6. 왕은 A 인물에게 증언을 요청한다.
7. A 인물은 증언으로 응답한다.

이 과정은 요청과 응답에 초점을 두어 보면 모두 각각의 객체가 협력을 하고 있는 것이고, 요청과 응답은 협력에 참여하는 객체가 수행할 책임을 정의한다.

<br>

### 책임
객체지향에서 어떤 객체가 어떤 요청에 의해 대답해줄 수 있거나, 행동할 의무가 있는 경우 `해당 객체는 책임을 가진다`고 말한다.

왕은 재판을 해야하고, 토끼는 목격자를 불러오고, 목격자는 증언을 해야하는 책임을 지게 된다. 그래서 어떤 객체의 요청이 다른 객체에게 요청을 처리할 책임이 있음을 암시한다고 볼 수 있다.

책임은 객체지향에서 핵심적인 것으로, 책임을 능숙하게 소프트웨어 객체에 할당하는 것이 가장 중요하다고 한다.

#### 책임의 분류
협력에 참여하는 객체들은 목표를 위해 본인의 책임을 수행한다. 책임은 객체에 의해 정의되는 응집도 있는 행위의 집합으로, 객체가 수행할 수 있는 행위에 대해 개략적으로 서술한 문장이다.

객체의 책임은 `객체가 무엇을 알고 있는가`와 `객체가 무엇을 할 수 있는가`로 두 가지에 의해 구성된다.

- 하는 것
  - 객체를 생성하거나 계산을 하는 등의 스스로 하는 것
  - 다른 객체의 행동을 시작시키는 것
  - 다른 객체의 활동을 제어하고 조절하는 것
- 아는 것
  - 개인적인 정보에 관해 아는 것
  - 관련된 객체에 관해 아는 것
  - 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것

객체의 책임을 이야기할 때는 일반적으로 **외부에서 접근 가능한 공용 서비스 관점**에서 이야기 한다.

책임은 객체의 외부에 제공해줄 수 있는 정보(아는 것)와 외부에 제공해줄 수 있는 서비스(하는 것)의 목록으로, 책임은 객체의 공용 인터페이스를 구성한다.

<br>

### 역할
#### 책임의 집합이 의미하는 것
책임을 가지는 것은 무엇을 의미할까, 재판이라는 협력에 참여하기 위해 왕은 판사의 역할을, A 인물은 증인의 역할을 수행하고 있음을 의미한다.

역할은 재사용 가능하고 유연한 객체지향 설계를 낳는 중요한 구성요소이다.

만약 왕이 아닌 여왕이 대신 재판을 해야한다면 왕이 재판, 여왕이 재판과 같이 별도로 관리하고 유지해야 할 것이다. 또 다른 사람이 나타나도 마찬가지이다.

왕은 판사로, A 인물은 증인이라는 역할을 부여하면 이들을 각각 관리하지 않아도 모두 포괄할 수 있는 하나의 협력으로 추상화할 수 있다.

판사의 역할을 가지면, 재판하라는 메세지를 이해할 수 있고 처리할 수 있기 때문에 재사용 가능하다고 볼 수 있다.

메세지가 책임을 의미한다고 했는데, 결국 동일한 역할을 수행할 수 있다는 것은 해당 객체들이 협력 내에서 동일한 책임의 집합을 수행할 수 있다는 것을 의미한다.

**동일한 역할을 수행하는 객체들이, 동일한 메세지를 수신할 수 있기 때문에 동일한 책임을 수행할 수 있다**

우리는 역할의 개념을 통해 유사한 협력을 추상화하고, 단순성 유연성 재사용성을 챙길 수 있다.

#### 대체 가능성
역할은 협력 안에서 구체적인 객체로 대체될 수 있는 추상적인 협력자다.

본질적으로 역할은 **다른 객체에 의해 대체 가능함**을 의미하고, 이는 반드시 행동이 호환돼야 한다.

<br>

### 객체의 모양을 결정하는 협력
많은 사람들은 데이터 저장을 위해 객체가 존재해야 한다고 알지만, 데이터는 객체가 행위를 수행하는데 필요한 재료일 뿐이다.

또한, 객체지향의 중요한 점은 정적인 클래스가 아니라, 협력에 참여하는 동적인 객체이다. 왕의 생김새는 전혀 중요하지 않고 재판을 한다는 협력의 행동을 먼저 고려해야 하는 것처럼 말이다.

따라서 설계할 때에는 행동을 결정한 후에, 그 행동을 수행하는데 필요한 데이터를 고민해야 한다. 그리고 객체가 협력 참여를 위한 데이터와 행동이 어느정도 결정되었을 때, 클래스 구현 방법을 결정해야 한다.

객체지향 시스템에서 가장 중요한 것은 자율적인 동시에 충분히 협력적인 객체를 창조하는 것으로, 일단 협력하게 한 후에 협력 문맥 안에서 객체를 자유롭게 만드는 것이다.

<br>

### 객체지향 설계 기법
역할, 책임, 협력이 견고하고 유연한 객체지향 설계를 낳는다는 것을 알았다. 이 세 관점에서 애플리케이션을 설계하는 기법들이 있다.

#### 책임-주도 설계(Responsibility-Driven Design)
객체지향 설계란, 앱을 구현하기 위한 협력 관계를 고안하고 협력에 필요한 역할과 책임을 식별한 후 이를 수행할 수 있는 적절한 객체를 식별해 나가는 과정이다.

여기서 핵심은 올바른 책임을 올바른 객체에게 할당하는 것으로, 이 설계에서는 시스템 전체의 책임을 객체의 책임으로 변환하고, 각 객체가 책임을 수행할 수 있게 협력자에게 책임을 할당하는 순차적 방식의 객체 협력 공동체를 구축한다.

그래서 개별적인 객체의 상태가 아니라, 객체의 책임과 상호작용에 집중하는 것이다.

#### 디자인 패턴
책임-주도 설계의 결과를 표현하는 것으로 반복적으로 발생하는 문제와 그 문제에 대한 해법의 쌍으로 정의된다.

GOF 디자인 패턴으로 23개의 디자인 패턴이 정리되어 있다.

#### 테스트-주도 개발
에자일 방법론의 한 종류인 XP로 소개되며 주목받기 시작한 설계 기법이다.

테스트를 작성하는 것이 아니라, 책임을 수행할 객체가 기대하는 객체의 역할이 메세지를 수신할 때, 어떤 결과를 반환하고 그 과정에 어떤 객체와 협력할 것인지에 대한 기대를 코드로 작성하는 것이다.

응집도가 높고, 결합도가 낮은 클래스로 구성된 시스템을 개발할 수 있지만, 다양한 설계 경험이나 패턴에 대한 지식이 없으면 어렵다.
